# GCP & Workspace ATT&CK Matrix

This community based matrix main objective is to outlines a comprehensive list of Tactics, Techniques, and Procedures (TTPs) used by threat actor and applicable to Google Cloud Platform (GCP) and Google Workspace environments. 

It is a community-driven project designed to help security professionals, red teamers, and blue teamers understand and defend against threats in the Google Cloud ecosystem.

| Tactic | Technique |
| :--- | :--- |
| **Reconnaissance** | <ul><li>Scan for Public Cloud Storage Buckets & Public VM Snapshots</li><li>Enumerate Google Groups for sensitive user congregations</li><li>OSINT: Search public code repositories (GitHub, GitLab) for leaked credentials</li><li>OSINT: Analyze job postings & employee profiles for tech stack info</li><li>Analyze Certificate Transparency logs for subdomains and services</li><li>Probe Google login endpoints to validate employee email addresses</li><li>Discover public-facing Cloud Functions, Cloud Run, and App Engine services</li><li>Search for exposed GCP service hostnames in public datasets (e.g., Shodan)</li></ul> |
| **Initial Access** | <ul><li>Leaked Service Account Keys (from code, configs, or internal shares)</li><li>OAuth Device Code Phishing against Workspace users</li><li>Vulnerable Web Application on GCE/GKE (SSRF, RCE, SQLi)</li><li>Compromised Third-Party OAuth Application with existing permissions</li><li>Exposed VM with weak SSH/RDP credentials or an unpatched vulnerability</li><li>Compromised CI/CD Pipeline credentials (e.g., tokens from a self-hosted runner)</li><li>GCP Marketplace Application with a known N-day vulnerability</li><li>Session Hijacking via stolen browser cookies for an authenticated GCP console session</li><li>Supply Chain Attack via a compromised container image in Artifact Registry</li></ul> |
| **Execution** | <ul><li>Remote Code Execution via `gcloud compute ssh`</li><li>Injecting commands into VM `startup-script` or `shutdown-script` metadata</li><li>Deploying a malicious Cloud Function or Cloud Run service</li><li>Triggering a malicious Cloud Build pipeline with arbitrary commands</li><li>Executing a job on a Dataflow or Dataproc cluster</li><li>Deploying a malicious container to a GKE cluster (e.g., a cryptominer)</li><li>Running commands interactively via the GCE Serial Console</li><li>Abusing Cloud Scheduler to trigger malicious functions on a timer</li><li>Executing a malicious multi-step process using Cloud Workflows</li></ul> |
| **Persistence** | <ul><li>Create new, long-lived keys for a powerful Service Account</li><li>Add an attacker-controlled principal (user or service account) to a high-level IAM policy</li><li>Modify a VM's metadata to add an attacker's SSH key</li><li>Create a malicious OAuth application and grant it admin consent in Workspace</li><li>Backdoor an Infrastructure-as-Code (IaC) template (Terraform, Deployment Manager)</li><li>Create a Cloud Build trigger that re-establishes access if removed</li><li>Plant a malicious web shell on an App Engine application</li><li>Modify a GKE DaemonSet to ensure a malicious pod runs on every node</li></ul> |
| **Privilege Escalation** | <ul><li>Abuse `iam.serviceAccounts.actAs` to impersonate a privileged service account</li><li>Exploit broad permissions of a primitive role (e.g., `roles/editor`)</li><li>Leverage the Compute Engine default service account's powerful default role</li><li>Exploit a custom IAM role that includes `resourceremanager.projects.setIamPolicy`</li><li>Exploit a custom IAM role that includes `iam.serviceAccountKeys.create` on any service account</li><li>Abuse `iam.roles.update` on a manageable custom role to add privileged permissions</li><li>Exploit permissions to use the `gcloud beta asset` API to find hidden privilege paths</li><li>Escalate from a compromised GKE pod to the underlying node via misconfigurations</li><li>Leverage a trusted Service Account from another GCP project (Cross-Project Trust Abuse)</li><li>Abuse permissions to launch a GCE instance with a more privileged service account</li><li>Exploit OS Login misconfigurations to escalate from user to root on a VM</li></ul> |
| **Defense Evasion** | <ul><li>Disable or reconfigure Cloud Logging sinks to stop sending audit logs</li><li>Delete or modify specific log entries using APIs if permissions allow</li><li>Disable or suppress Security Command Center findings and alerts</li><li>Use Google's own APIs (e.g., Cloud Storage APIs from a VM) to bypass VPC Service Controls</li><li>Stop or delete VM instances after an attack to remove forensic evidence</li><li>Use easily confusable names for malicious resources (e.g., `gco-utility-service-acct`)</li><li>Clear or modify command history within a compromised VM or Cloud Shell</li><li>Abuse `iam.denyPolicies` to block security tools from accessing resources</li></ul> |
| **Credential Access** | <ul><li>Query the GCE metadata service for the attached service account's access token</li><li>Access secrets stored in Secret Manager with `secretmanager.versions.access`</li><li>Read credentials hardcoded in VM metadata, environment variables, or source code</li><li>Extract Kubernetes secrets from a compromised GKE cluster</li><li>Steal OAuth refresh/access tokens for Workspace from a user's local machine</li><li>Dump credentials from memory of processes running on a compromised VM</li><li>Use a service account with Domain-Wide Delegation to generate user impersonation tokens</li></ul> |
| **Discovery** | <ul><li>Probe permissions with `iam.testIamPermissions`</li><li>List all IAM policies on the Organization, Folders, and Projects</li><li>List all enabled APIs and services (`gcloud services list`)</li><li>Enumerate all Cloud Storage buckets, VMs, and Cloud SQL databases</li><li>Map the network by listing VPCs, subnets, and firewall rules</li><li>List all GKE clusters and their node pools</li><li>Enumerate users and groups within the Google Workspace directory</li><li>List all manageable and attachable service accounts in a project</li><li>Check Organization Policies for security constraints</li></ul> |
| **Collection** | <ul><li>Download data from Cloud Storage buckets using `gsutil cp` or `gsutil rsync`</li><li>Query sensitive datasets in BigQuery</li><li>Access and download files from Google Drive and emails from Gmail via Workspace APIs</li><li>Create and download snapshots of VM disks for offline analysis</li><li>Connect to a Cloud SQL instance and dump databases</li><li>Access application data from Firestore or Spanner</li><li>Read secrets and configurations from Secret Manager or HashiCorp Vault</li></ul> |
| **Exfiltration** | <ul><li>Transfer data directly from a Cloud Storage bucket to an external attacker bucket</li><li>Use a compromised GCE VM as a proxy to exfiltrate data to an external server</li><li>Exfiltrate data slowly via DNS queries from a compromised resource (DNS Tunneling)</li><li>Use an HTTP-triggered Cloud Function to send data to an attacker's webhook</li><li>Use the Cloud SQL Proxy to exfiltrate database contents over a secure channel</li><li>Abuse legitimate data transfer tools like BigQuery transfers or Storage Transfer Service</li></ul> |
| **Impact** | <ul><li>Ransomware: Encrypt data in buckets or on VMs and delete the KMS keys</li><li>Destruction: Delete projects, folders, VMs, databases, or IAM policies</li><li>Resource Hijacking: Deploy large-scale cryptomining operations on GCE or GKE</li><li>Data Manipulation: Corrupt or subtly alter critical data in databases to undermine integrity</li><li>Traffic Hijacking: Modify Cloud DNS or Load Balancer settings to redirect users</li><li>Account Lockout: Change IAM policies or reset Workspace user passwords to lock out legitimate users</li></ul> |